<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Huibers Auto's</title>
    <link rel="stylesheet" href="css/stylesheet.css" type="text/css"/>

</head>
<body>


<div id="main">
    <h2>login</h2>
    <form id="loginform">
        <label for="username"><b>Username:</b></label> <br>
        <input type="text" placeholder="Enter Username" id="username" name="username"/><br>
        <label for="password"><b>Wachtwoord:</b></label> <br>
        <input type="text"  placeholder="Enter password" id="password" name="password"/><br>

    </form>
    <br>
    <button type="button" name=login" id="login"> login</button>
    <br><br>
    <a href="admin.html">functies admin</a>
    <p></p>



    <br>
    <hr>
    <br>
</div>


<script type="text/javascript">

    function login(event) {
        var formData = new FormData(document.querySelector("#loginform"));
        var encData = new URLSearchParams(formData.entries());

        fetch("restservices/authentication", {method: "POST", body: encData})
            .then(function (response) {
                if (response.ok) return response.json();
                else throw "wrong username/password";
            })
            .then(myJson => window.sessionStorage.setItem("myJWT", myJson.JWT)
                .catch(error => console.log(error)));


    }
    document.querySelector("#login").addEventListener("click", login);






</script>


</body>
</html>